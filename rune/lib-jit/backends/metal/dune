(library
 (name rune_jit_metal)
 (public_name rune.jit.metal)
 (modules rune_jit_metal)
 (enabled_if
  (= %{system} "macosx"))
 (libraries metal ctypes ctypes-foreign integers rune_jit))

(library
 (name rune_jit_metal_or_missing)
 (public_name rune.jit.metal_or_missing)
 (modules rune_jit_metal_or_missing)
 (libraries
  rune_jit
  (select
   rune_jit_metal_or_missing.ml
   from
   (rune.jit.metal -> rune_jit_metal_or_missing.present.ml)
   (-> rune_jit_metal_or_missing.missing.ml))))
