# Nx Benchmarks

This directory contains benchmarks for the nx library. We provide comparative benchmarks against NumPy.

Additional focused suites live under subdirectories:

- `conv2d/` for convolutional workloads
- `einsum/` for tensor contractions
- `matmul/` for dense matrix multiplication

## Results Nx

```
┌────────────────────────────┬──────────┬──────────┬─────────┬─────────┬────────────┐
│ Name                       │ Wall/Run │  CPU/Run │ mWd/Run │ Speedup │ vs Fastest │
├────────────────────────────┼──────────┼──────────┼─────────┼─────────┼────────────┤
│ Transpose 100x100 f32 (Nx) │ 132.92ns │ 174.70ns │ 114.00w │   1.00x │       100% │
│ Transpose 200x200 f64 (Nx) │ 144.19ns │ 162.57ns │ 114.00w │   0.92x │       108% │
│ Transpose 50x50 f32 (Nx)   │ 145.52ns │ 184.50ns │ 114.00w │   0.91x │       109% │
│ Transpose 500x500 f64 (Nx) │ 147.02ns │ 166.86ns │ 114.00w │   0.90x │       111% │
│ Transpose 100x100 f64 (Nx) │ 147.10ns │ 232.42ns │ 114.00w │   0.90x │       111% │
│ Transpose 500x500 f32 (Nx) │ 148.00ns │ 162.61ns │ 114.00w │   0.90x │       111% │
│ Transpose 200x200 f32 (Nx) │ 150.68ns │ 170.96ns │ 114.00w │   0.88x │       113% │
│ Transpose 50x50 f64 (Nx)   │ 158.90ns │ 161.09ns │ 114.00w │   0.84x │       120% │
│ Mul 50x50 f32 (Nx)         │   1.61μs │   1.61μs │ 808.00w │   0.08x │      1211% │
│ Mul 50x50 f64 (Nx)         │   1.74μs │   1.68μs │ 808.00w │   0.08x │      1311% │
│ Add 50x50 f64 (Nx)         │   1.77μs │   1.82μs │ 808.00w │   0.07x │      1335% │
│ Add 50x50 f32 (Nx)         │   1.83μs │   1.83μs │ 808.00w │   0.07x │      1374% │
│ Mul 100x100 f32 (Nx)       │   2.41μs │   2.52μs │ 808.00w │   0.06x │      1814% │
│ Add 100x100 f32 (Nx)       │   2.69μs │   2.69μs │ 808.00w │   0.05x │      2022% │
│ Sum 50x50 f64 (Nx)         │   3.23μs │   3.25μs │ 416.00w │   0.04x │      2432% │
│ Sum 50x50 f32 (Nx)         │   3.27μs │   3.24μs │ 416.00w │   0.04x │      2457% │
│ Mul 100x100 f64 (Nx)       │  22.87μs │  22.72μs │ 801.00w │   0.01x │     17206% │
│ Add 100x100 f64 (Nx)       │  24.60μs │  24.55μs │ 801.00w │   0.01x │     18510% │
│ Sum 100x100 f64 (Nx)       │  87.16μs │ 178.36μs │ 416.00w │   0.00x │     65571% │
│ Sum 100x100 f32 (Nx)       │  87.68μs │ 178.89μs │ 416.00w │   0.00x │     65966% │
│ Sum 200x200 f64 (Nx)       │  97.11μs │ 220.67μs │ 416.00w │   0.00x │     73060% │
│ Sum 200x200 f32 (Nx)       │  98.78μs │ 218.97μs │ 416.00w │   0.00x │     74315% │
│ Mul 200x200 f32 (Nx)       │ 105.68μs │ 152.89μs │ 801.00w │   0.00x │     79507% │
│ Add 200x200 f32 (Nx)       │ 109.71μs │ 161.79μs │ 801.00w │   0.00x │     82541% │
│ Sum 500x500 f32 (Nx)       │ 135.81μs │ 425.91μs │ 416.00w │   0.00x │    102173% │
│ Sum 500x500 f64 (Nx)       │ 139.32μs │ 427.21μs │ 416.00w │   0.00x │    104814% │
│ Mul 200x200 f64 (Nx)       │ 157.28μs │ 210.49μs │ 801.00w │   0.00x │    118332% │
│ Add 200x200 f64 (Nx)       │ 162.52μs │ 223.83μs │ 801.00w │   0.00x │    122270% │
│ Mul 500x500 f32 (Nx)       │ 195.66μs │ 271.61μs │ 801.00w │   0.00x │    147200% │
│ Add 500x500 f32 (Nx)       │ 204.88μs │ 301.06μs │ 801.00w │   0.00x │    154141% │
│ Mul 500x500 f64 (Nx)       │ 277.63μs │ 534.55μs │ 801.00w │   0.00x │    208873% │
│ Add 500x500 f64 (Nx)       │ 284.96μs │ 571.38μs │ 801.00w │   0.00x │    214386% │
└────────────────────────────┴──────────┴──────────┴─────────┴─────────┴────────────┘
```

## Results NumPy

```
┌───────────────────────────────┬──────────┬──────────┬─────────┬─────────┬────────────┐
│ Name                          │ Wall/Run │  CPU/Run │ mWd/Run │ Speedup │ vs Fastest │
├───────────────────────────────┼──────────┼──────────┼─────────┼─────────┼────────────┤
│ Transpose 200x200 f64 (NumPy) │ 309.12ns │ 308.61ns │   0.04w │   1.00x │       100% │
│ Transpose 500x500 f64 (NumPy) │ 310.86ns │ 310.27ns │   0.06w │   0.99x │       101% │
│ Transpose 100x100 f64 (NumPy) │ 311.56ns │ 309.53ns │   0.04w │   0.99x │       101% │
│ Transpose 50x50 f32 (NumPy)   │ 311.76ns │ 311.08ns │   0.04w │   0.99x │       101% │
│ Transpose 50x50 f64 (NumPy)   │ 313.21ns │ 312.09ns │   0.04w │   0.99x │       101% │
│ Transpose 200x200 f32 (NumPy) │ 313.63ns │ 312.67ns │   0.04w │   0.99x │       101% │
│ Transpose 500x500 f32 (NumPy) │ 315.64ns │ 313.60ns │   0.05w │   0.98x │       102% │
│ Transpose 100x100 f32 (NumPy) │ 322.03ns │ 315.85ns │   0.04w │   0.96x │       104% │
│ Add 50x50 f32 (NumPy)         │ 541.58ns │ 540.36ns │   0.06w │   0.57x │       175% │
│ Mul 50x50 f32 (NumPy)         │ 547.03ns │ 539.71ns │   0.06w │   0.57x │       177% │
│ Add 50x50 f64 (NumPy)         │ 688.90ns │ 688.46ns │   0.08w │   0.45x │       223% │
│ Mul 50x50 f64 (NumPy)         │ 775.58ns │ 711.24ns │   0.08w │   0.40x │       251% │
│ Mul 100x100 f32 (NumPy)       │   1.06µs │   1.06µs │   0.11w │   0.29x │       342% │
│ Add 100x100 f32 (NumPy)       │   1.08µs │   1.05µs │   0.12w │   0.29x │       351% │
│ Sum 50x50 f64 (NumPy)         │   1.88µs │   1.88µs │   0.20w │   0.16x │       608% │
│ Sum 50x50 f32 (NumPy)         │   1.90µs │   1.89µs │   0.20w │   0.16x │       615% │
│ Mul 100x100 f64 (NumPy)       │   2.54µs │   2.51µs │   0.32w │   0.12x │       822% │
│ Add 100x100 f64 (NumPy)       │   2.58µs │   2.52µs │   0.32w │   0.12x │       835% │
│ Sum 100x100 f32 (NumPy)       │   3.16µs │   3.16µs │   0.34w │   0.10x │      1023% │
│ Sum 100x100 f64 (NumPy)       │   3.16µs │   3.16µs │   0.34w │   0.10x │      1023% │
│ Mul 200x200 f32 (NumPy)       │   4.39µs │   4.37µs │   0.55w │   0.07x │      1419% │
│ Add 200x200 f32 (NumPy)       │   4.39µs │   4.38µs │   0.54w │   0.07x │      1421% │
│ Add 200x200 f64 (NumPy)       │   8.30µs │   8.21µs │   0.95w │   0.04x │      2685% │
│ Mul 200x200 f64 (NumPy)       │   8.45µs │   8.32µs │   0.97w │   0.04x │      2734% │
│ Sum 200x200 f32 (NumPy)       │   9.06µs │   8.94µs │   0.92w │   0.03x │      2931% │
│ Sum 200x200 f64 (NumPy)       │   9.53µs │   9.50µs │   1.26w │   0.03x │      3082% │
│ Add 500x500 f32 (NumPy)       │  24.95µs │  24.89µs │   3.01w │   0.01x │      8071% │
│ Mul 500x500 f32 (NumPy)       │  25.01µs │  24.95µs │   3.08w │   0.01x │      8090% │
│ Sum 500x500 f32 (NumPy)       │  43.39µs │  43.00µs │   5.57w │   0.01x │     14036% │
│ Sum 500x500 f64 (NumPy)       │  48.26µs │  48.03µs │   8.13w │   0.01x │     15614% │
│ Add 500x500 f64 (NumPy)       │ 159.37µs │ 159.03µs │  23.29w │   0.00x │     51557% │
│ Mul 500x500 f64 (NumPy)       │ 167.38µs │ 166.97µs │  28.98w │   0.00x │     54149% │
└───────────────────────────────┴──────────┴──────────┴─────────┴─────────┴────────────┘
```
