# Nx Benchmarks

This directory contains benchmarks for the nx library. We provide comparative benchmarks against NumPy.

Additional focused suites live under subdirectories:

- `conv2d/` for convolutional workloads
- `einsum/` for tensor contractions
- `matmul/` for dense matrix multiplication

## Results Nx

```
┌────────────────────────────┬──────────┬──────────┬─────────┬─────────┬────────────┐
│ Name                       │ Wall/Run │  CPU/Run │ mWd/Run │ Speedup │ vs Fastest │
├────────────────────────────┼──────────┼──────────┼─────────┼─────────┼────────────┤
│ Transpose 100x100 f64 (Nx) │ 134.37ns │ 151.10ns │ 114.00w │   1.00x │       100% │
│ Transpose 200x200 f32 (Nx) │ 153.82ns │ 178.67ns │ 114.00w │   0.87x │       114% │
│ Transpose 50x50 f32 (Nx)   │ 154.26ns │ 194.15ns │ 114.00w │   0.87x │       115% │
│ Transpose 200x200 f64 (Nx) │ 156.63ns │ 171.22ns │ 114.00w │   0.86x │       117% │
│ Transpose 500x500 f64 (Nx) │ 162.69ns │ 184.52ns │ 114.00w │   0.83x │       121% │
│ Transpose 100x100 f32 (Nx) │ 165.93ns │ 159.08ns │ 114.00w │   0.81x │       123% │
│ Transpose 50x50 f64 (Nx)   │ 168.53ns │ 143.88ns │ 114.00w │   0.80x │       125% │
│ Transpose 500x500 f32 (Nx) │ 176.57ns │ 152.77ns │ 114.00w │   0.76x │       131% │
│ Sum 50x50 f64 (Nx)         │   3.23μs │   3.24μs │ 416.00w │   0.04x │      2405% │
│ Sum 50x50 f32 (Nx)         │   3.24μs │   3.23μs │ 416.00w │   0.04x │      2411% │
│ Mul 50x50 f32 (Nx)         │  40.98μs │  76.89μs │ 808.00w │   0.00x │     30500% │
│ Mul 50x50 f64 (Nx)         │  42.38μs │  75.92μs │ 808.00w │   0.00x │     31539% │
│ Add 50x50 f64 (Nx)         │  43.35μs │  81.65μs │ 808.00w │   0.00x │     32260% │
│ Add 50x50 f32 (Nx)         │  43.51μs │  81.63μs │ 808.00w │   0.00x │     32383% │
│ Add 100x100 f32 (Nx)       │  43.66μs │  81.52μs │ 808.00w │   0.00x │     32490% │
│ Mul 100x100 f32 (Nx)       │  45.42μs │  82.83μs │ 808.00w │   0.00x │     33807% │
│ Mul 100x100 f64 (Nx)       │  74.90μs │ 119.52μs │ 801.00w │   0.00x │     55744% │
│ Add 100x100 f64 (Nx)       │  80.45μs │ 126.02μs │ 801.00w │   0.00x │     59873% │
│ Sum 100x100 f64 (Nx)       │  84.61μs │ 173.93μs │ 416.00w │   0.00x │     62969% │
│ Sum 100x100 f32 (Nx)       │  85.59μs │ 173.39μs │ 416.00w │   0.00x │     63698% │
│ Sum 200x200 f32 (Nx)       │  94.76μs │ 213.87μs │ 416.00w │   0.00x │     70522% │
│ Sum 200x200 f64 (Nx)       │  96.08μs │ 213.51μs │ 416.00w │   0.00x │     71509% │
│ Add 200x200 f32 (Nx)       │ 106.17μs │ 154.58μs │ 801.00w │   0.00x │     79014% │
│ Mul 200x200 f32 (Nx)       │ 106.32μs │ 152.81μs │ 801.00w │   0.00x │     79124% │
│ Sum 500x500 f64 (Nx)       │ 135.62μs │ 425.32μs │ 416.00w │   0.00x │    100936% │
│ Sum 500x500 f32 (Nx)       │ 138.88μs │ 431.24μs │ 416.00w │   0.00x │    103362% │
│ Mul 200x200 f64 (Nx)       │ 152.03μs │ 206.01μs │ 801.00w │   0.00x │    113149% │
│ Add 200x200 f64 (Nx)       │ 158.67μs │ 215.84μs │ 801.00w │   0.00x │    118085% │
│ Mul 500x500 f32 (Nx)       │ 189.50μs │ 267.99μs │ 801.00w │   0.00x │    141030% │
│ Add 500x500 f32 (Nx)       │ 198.45μs │ 281.62μs │ 801.00w │   0.00x │    147691% │
│ Mul 500x500 f64 (Nx)       │ 266.39μs │ 524.63μs │ 801.00w │   0.00x │    198256% │
│ Add 500x500 f64 (Nx)       │ 275.09μs │ 562.25μs │ 801.00w │   0.00x │    204732% │
└────────────────────────────┴──────────┴──────────┴─────────┴─────────┴────────────┘
```

## Results NumPy

```
┌───────────────────────────────┬──────────┬──────────┬─────────┬─────────┬────────────┐
│ Name                          │ Wall/Run │  CPU/Run │ mWd/Run │ Speedup │ vs Fastest │
├───────────────────────────────┼──────────┼──────────┼─────────┼─────────┼────────────┤
│ Transpose 200x200 f64 (NumPy) │ 309.12ns │ 308.61ns │   0.04w │   1.00x │       100% │
│ Transpose 500x500 f64 (NumPy) │ 310.86ns │ 310.27ns │   0.06w │   0.99x │       101% │
│ Transpose 100x100 f64 (NumPy) │ 311.56ns │ 309.53ns │   0.04w │   0.99x │       101% │
│ Transpose 50x50 f32 (NumPy)   │ 311.76ns │ 311.08ns │   0.04w │   0.99x │       101% │
│ Transpose 50x50 f64 (NumPy)   │ 313.21ns │ 312.09ns │   0.04w │   0.99x │       101% │
│ Transpose 200x200 f32 (NumPy) │ 313.63ns │ 312.67ns │   0.04w │   0.99x │       101% │
│ Transpose 500x500 f32 (NumPy) │ 315.64ns │ 313.60ns │   0.05w │   0.98x │       102% │
│ Transpose 100x100 f32 (NumPy) │ 322.03ns │ 315.85ns │   0.04w │   0.96x │       104% │
│ Add 50x50 f32 (NumPy)         │ 541.58ns │ 540.36ns │   0.06w │   0.57x │       175% │
│ Mul 50x50 f32 (NumPy)         │ 547.03ns │ 539.71ns │   0.06w │   0.57x │       177% │
│ Add 50x50 f64 (NumPy)         │ 688.90ns │ 688.46ns │   0.08w │   0.45x │       223% │
│ Mul 50x50 f64 (NumPy)         │ 775.58ns │ 711.24ns │   0.08w │   0.40x │       251% │
│ Mul 100x100 f32 (NumPy)       │   1.06µs │   1.06µs │   0.11w │   0.29x │       342% │
│ Add 100x100 f32 (NumPy)       │   1.08µs │   1.05µs │   0.12w │   0.29x │       351% │
│ Sum 50x50 f64 (NumPy)         │   1.88µs │   1.88µs │   0.20w │   0.16x │       608% │
│ Sum 50x50 f32 (NumPy)         │   1.90µs │   1.89µs │   0.20w │   0.16x │       615% │
│ Mul 100x100 f64 (NumPy)       │   2.54µs │   2.51µs │   0.32w │   0.12x │       822% │
│ Add 100x100 f64 (NumPy)       │   2.58µs │   2.52µs │   0.32w │   0.12x │       835% │
│ Sum 100x100 f32 (NumPy)       │   3.16µs │   3.16µs │   0.34w │   0.10x │      1023% │
│ Sum 100x100 f64 (NumPy)       │   3.16µs │   3.16µs │   0.34w │   0.10x │      1023% │
│ Mul 200x200 f32 (NumPy)       │   4.39µs │   4.37µs │   0.55w │   0.07x │      1419% │
│ Add 200x200 f32 (NumPy)       │   4.39µs │   4.38µs │   0.54w │   0.07x │      1421% │
│ Add 200x200 f64 (NumPy)       │   8.30µs │   8.21µs │   0.95w │   0.04x │      2685% │
│ Mul 200x200 f64 (NumPy)       │   8.45µs │   8.32µs │   0.97w │   0.04x │      2734% │
│ Sum 200x200 f32 (NumPy)       │   9.06µs │   8.94µs │   0.92w │   0.03x │      2931% │
│ Sum 200x200 f64 (NumPy)       │   9.53µs │   9.50µs │   1.26w │   0.03x │      3082% │
│ Add 500x500 f32 (NumPy)       │  24.95µs │  24.89µs │   3.01w │   0.01x │      8071% │
│ Mul 500x500 f32 (NumPy)       │  25.01µs │  24.95µs │   3.08w │   0.01x │      8090% │
│ Sum 500x500 f32 (NumPy)       │  43.39µs │  43.00µs │   5.57w │   0.01x │     14036% │
│ Sum 500x500 f64 (NumPy)       │  48.26µs │  48.03µs │   8.13w │   0.01x │     15614% │
│ Add 500x500 f64 (NumPy)       │ 159.37µs │ 159.03µs │  23.29w │   0.00x │     51557% │
│ Mul 500x500 f64 (NumPy)       │ 167.38µs │ 166.97µs │  28.98w │   0.00x │     54149% │
└───────────────────────────────┴──────────┴──────────┴─────────┴─────────┴────────────┘
```
